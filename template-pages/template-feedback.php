<?php

/*
Template Name: Feedback
Template Post Type: page
*/

get_header();


$icoda_feedback_page_title = get_field('icoda_feedback_page_title');
$icoda_feedback_message_block = get_field('icoda_feedback_message_block');
$icoda_feedback_questions = get_field('icoda_feedback_questions');
$icoda_feedback_thankyou_text = get_field('icoda_feedback_thankyou_text');

?>
<main class="page-feedback">

    <div class="container">
        <div class="row">
            <div class="col-12">
                <?php the_breadcrumbs(); ?>
            </div>
            <div class="col-12">
                <h1 class="h2 title-main">
                    <?php echo $icoda_feedback_page_title; ?>
                </h1>
            </div>
            <div class="col-12">
                <div class="feedback-block d-flex flex-column flex-lg-row align-items-lg-center">
                    <div class="chat-img">
                        <img src="/wp-content/uploads/2022/11/chat.svg" alt="chat">
                    </div>
                    <div class="chat-text">
                        <p class="title font-weight-normal"><?php echo $icoda_feedback_message_block['title']; ?></p>
                        <p class="title font-weight-normal mb-4 pb-1 pb-lg-1 mb-lg-1"><?php echo $icoda_feedback_message_block['subtitle']; ?></p>
                        <p class="text"><?php echo $icoda_feedback_message_block['description']; ?></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <section class="section-feedback">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <form method="post" class="feedback-form" action="">
                        <input type="hidden" name="feedback_page_id" value="<?php echo get_the_ID(); ?>">

                        <?php
                        $prev_type = false;
                        $current_type = false;
                        $openned_list = false;
                        ?>
                        <?php foreach ($icoda_feedback_questions as $index => $question_data) : ?>

                            <?php
                            $current_type = $question_data['type'];
                            ?>

                            <?php if ($current_type === 'text' || $current_type === 'textarea') : ?>
                                <?php if (!$openned_list) : ?>
                                    <?php echo '<ul class="question-list">'; ?>
                                    <?php $openned_list = true; ?>
                                <?php endif; ?>
                            <?php endif; ?>

                            <?php if ($current_type !== 'text' && $current_type !== 'textarea' && ($prev_type === 'text' || $prev_type === 'textarea')) : ?>
                                <?php if ($openned_list) : ?>
                                    <?php echo '</ul>'; ?>
                                    <?php $openned_list = false; ?>
                                <?php endif; ?>
                            <?php endif; ?>

                            <?php if ($current_type === 'yesno') : ?>
                                <div class="recommendation d-flex flex-column flex-lg-row align-items-lg-center">
                                    <p class="h4 title mb-4 pb-2 pb-lg-0 mb-lg-0 mr-lg-4"><?php echo $question_data['question']; ?></p>
                                    <ul class="recommend-list d-flex">
                                        <li class="radio-toolbar">
                                            <input type="radio" id="like-<?php echo $index; ?>" name="recommend<?php echo $index; ?>" value="like">
                                            <label for="like-<?php echo $index; ?>">
                                                <svg width="66" height="66" viewBox="0 0 66 66" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M45.9547 65.8793C45.0147 65.8793 44.0847 65.8493 43.1847 65.7793C39.3447 65.4893 35.4747 64.9493 31.7347 64.4293C30.0847 64.1993 28.4447 63.9693 26.7947 63.7593C26.0147 63.6593 25.2247 63.5793 24.4347 63.4993C22.9047 63.3393 21.3247 63.1793 19.7747 62.8793C15.9247 62.1493 14.2747 60.2593 14.0947 56.3693C13.9747 53.8993 14.0047 51.3893 14.0347 48.9693C14.0447 47.8793 14.0547 46.7793 14.0547 45.6893C14.0547 44.8293 14.0647 43.9693 14.0747 43.0993C14.0947 41.1793 14.1247 39.1893 14.0247 37.2493C13.8547 34.0893 14.9647 31.4493 17.3947 29.1793C18.4447 28.1993 19.5147 27.2493 20.5747 26.2893C22.6047 24.4693 24.6947 22.5993 26.5947 20.6193C28.6147 18.5293 30.5847 16.1093 33.0147 12.7493C34.5247 10.6493 35.4747 8.30929 35.8347 5.79929C35.9247 5.15929 36.0947 4.55929 36.2647 3.97929L36.3047 3.84929C36.5547 2.94929 37.2347 0.569292 39.7947 0.109292C41.9647 -0.280708 43.8047 0.379292 45.1247 1.98929C47.1447 4.46929 48.0447 7.60929 47.7847 11.3293C47.4947 15.5693 46.1447 19.4393 43.7647 22.8193C42.8547 24.1093 42.2447 25.1293 41.7947 26.0993C41.6047 26.5093 41.6047 26.7693 41.6547 26.8593C41.7047 26.9493 41.8947 27.0593 42.2747 27.1193C43.8147 27.3393 45.4747 27.2793 46.9247 27.2293C48.6347 27.1693 50.3447 27.0793 52.0547 26.9993C53.9147 26.9093 55.7747 26.8093 57.6347 26.7493C58.5447 26.7193 59.4347 26.9393 60.3247 27.1993C62.5047 27.8093 64.1147 29.1393 64.8547 30.9293C65.5947 32.7093 65.3947 34.7793 64.2847 36.7393C63.5247 38.0893 63.2147 38.9993 63.6447 40.2293C64.2647 42.0493 63.8147 43.9293 62.4147 45.3793C61.3147 46.5193 61.0647 47.5493 61.5447 48.9293C62.3047 51.0993 61.7047 53.1493 59.8747 54.5593C58.6247 55.5193 58.2447 56.5893 58.5447 58.2493C58.8247 59.8093 58.4847 61.3693 57.5847 62.6493C56.6347 63.9993 55.1347 64.9093 53.3747 65.2093C50.8147 65.6393 48.3347 65.8593 45.9547 65.8593V65.8793ZM16.0547 45.6893C16.0547 46.7893 16.0447 47.8893 16.0347 48.9993C16.0047 51.3993 15.9847 53.8693 16.0947 56.2893C16.2347 59.2793 17.1847 60.3593 20.1447 60.9293C21.6147 61.2093 23.1447 61.3693 24.6347 61.5193C25.4347 61.5993 26.2447 61.6893 27.0447 61.7893C28.7047 61.9993 30.3547 62.2293 32.0147 62.4593C35.7247 62.9793 39.5647 63.5093 43.3347 63.7893C46.3547 64.0193 49.6247 63.8393 53.0447 63.2693C54.2747 63.0593 55.3047 62.4493 55.9547 61.5293C56.5447 60.6893 56.7647 59.6593 56.5847 58.6393C56.1547 56.2393 56.8147 54.4493 58.6647 53.0193C59.8047 52.1393 60.1447 50.9993 59.6647 49.6393C58.9247 47.5493 59.3547 45.7193 60.9847 44.0393C61.8647 43.1293 62.1347 42.0293 61.7647 40.9293C61.0347 38.7993 61.7947 37.1693 62.5547 35.8093C63.3547 34.3893 63.5147 32.9493 63.0247 31.7393C62.5247 30.5293 61.3747 29.6193 59.7947 29.1693C59.0247 28.9493 58.3447 28.7793 57.7047 28.7993C55.8547 28.8593 54.0047 28.9493 52.1547 29.0493C50.4347 29.1393 48.7147 29.2193 46.9947 29.2893C45.4547 29.3493 43.7147 29.4093 41.9847 29.1593C40.7247 28.9793 40.1547 28.3593 39.8847 27.8693C39.6147 27.3693 39.4047 26.5193 39.9747 25.3093C40.6247 23.9193 41.4647 22.6593 42.1247 21.7193C44.2947 18.6393 45.5247 15.1193 45.7847 11.2393C46.0047 7.99929 45.2847 5.39929 43.5647 3.29929C42.7247 2.25929 41.5647 1.86929 40.1347 2.11929C39.1647 2.28929 38.6447 2.91929 38.2147 4.42929L38.1747 4.55929C38.0247 5.09929 37.8747 5.60929 37.8047 6.11929C37.4047 8.94929 36.3347 11.5893 34.6347 13.9493C32.1547 17.3893 30.1147 19.8893 28.0347 22.0393C26.0847 24.0593 23.9547 25.9693 21.9047 27.8093C20.8447 28.7593 19.7847 29.7093 18.7547 30.6693C16.7547 32.5393 15.8847 34.5993 16.0147 37.1693C16.1147 39.1693 16.0947 41.1893 16.0747 43.1493C16.0747 43.9993 16.0547 44.8593 16.0547 45.7093V45.6893Z" fill="currentColor" />
                                                    <path d="M6.23444 64.0292C5.19444 64.0292 4.16444 64.0292 3.12444 64.0092C0.944439 63.9792 0.0144444 63.0292 0.00444444 60.8292C-0.00555556 57.6992 0.00444444 54.5692 0.00444444 51.4292V47.7392V44.1892C0.00444444 41.1092 0.00444444 38.0292 0.00444444 34.9392C0.00444444 32.3492 0.944442 31.4292 3.56444 31.4192H4.37444C5.97444 31.4192 7.57444 31.4092 9.16444 31.4192C11.3244 31.4492 12.3744 32.4792 12.3744 34.5592C12.3944 43.3292 12.3944 52.1092 12.3744 60.8792C12.3744 62.9992 11.3544 63.9892 9.16444 64.0092C8.18444 64.0092 7.20444 64.0192 6.23444 64.0192V64.0292ZM2.00444 46.7392V51.4292C2.00444 54.5592 2.00444 57.6892 2.01444 60.8192C2.01444 61.9592 2.11444 61.9992 3.15444 62.0092C5.15444 62.0392 7.15444 62.0292 9.14444 62.0092C10.2744 62.0092 10.3644 61.8292 10.3644 60.8792C10.3844 52.1092 10.3844 43.3392 10.3644 34.5692C10.3644 33.6492 10.2444 33.4392 9.12444 33.4192C7.54444 33.3992 5.95445 33.4092 4.36445 33.4192H3.55444C2.02444 33.4192 1.99444 33.4592 1.99444 34.9492C1.99444 38.0292 1.99444 41.1092 1.99444 44.1892V46.7392H2.00444Z" fill="currentColor" />
                                                </svg>
                                            </label>
                                        </li>
                                        <li class="radio-toolbar">
                                            <input type="radio" id="dislike-<?php echo $index; ?>" name="recommend<?php echo $index; ?>" value="dislike">
                                            <label for="dislike-<?php echo $index; ?>">
                                                <svg width="66" height="66" viewBox="0 0 66 66" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M24.3305 65.8599C22.6705 65.8599 21.2505 65.1799 20.1805 63.8699C18.1605 61.3899 17.2605 58.2499 17.5205 54.5299C17.8105 50.2899 19.1605 46.4199 21.5405 43.0399C22.4505 41.7499 23.0605 40.7399 23.5105 39.7599C23.7005 39.3499 23.7005 39.0899 23.6505 38.9999C23.6005 38.9099 23.4105 38.7899 23.0305 38.7399C21.5905 38.5299 20.1305 38.5599 18.3805 38.6299C16.6605 38.6899 14.9505 38.7799 13.2305 38.8599C11.3805 38.9499 9.52048 39.0499 7.67048 39.1099C6.74048 39.1399 5.88048 38.9099 4.98048 38.6599C2.80048 38.0499 1.19048 36.7199 0.450481 34.9299C-0.289519 33.1499 -0.0895194 31.0799 1.02048 29.1199C1.78048 27.7699 2.09048 26.8599 1.66048 25.6299C1.04048 23.8099 1.49048 21.9299 2.89048 20.4799C3.99048 19.3399 4.24048 18.3099 3.76048 16.9299C3.00048 14.7599 3.60048 12.7099 5.43048 11.2999C6.68048 10.3399 7.06048 9.26993 6.76048 7.60993C6.48048 6.04993 6.82048 4.48993 7.72048 3.20993C8.67048 1.85993 10.1705 0.949928 11.9305 0.649927C15.5005 0.0499275 18.9305 -0.140072 22.1105 0.0999275C25.9505 0.389928 29.8205 0.929928 33.5605 1.44993C35.2105 1.67993 36.8605 1.90993 38.5105 2.11993C39.3005 2.21993 40.0805 2.29993 40.8705 2.37993C42.4005 2.53993 43.9805 2.69993 45.5305 2.99993C49.3805 3.72993 51.0305 5.61993 51.2105 9.50993C51.3305 11.9799 51.3005 14.4899 51.2705 16.9099C51.2605 17.9999 51.2505 19.0999 51.2505 20.1899C51.2505 21.0499 51.2405 21.9099 51.2305 22.7799C51.2105 24.6999 51.1805 26.6899 51.2805 28.6299C51.4505 31.7899 50.3405 34.4299 47.9105 36.6999C46.8605 37.6799 45.7905 38.6299 44.7305 39.5899C42.7005 41.4099 40.6105 43.2799 38.7105 45.2599C36.6905 47.3499 34.7105 49.7799 32.2905 53.1299C30.7805 55.2299 29.8305 57.5699 29.4705 60.0799C29.3805 60.7199 29.2105 61.3199 29.0405 61.8999L29.0005 62.0299C28.7505 62.9299 28.0705 65.3099 25.5105 65.7699C25.1005 65.8399 24.7105 65.8799 24.3305 65.8799V65.8599ZM20.4205 36.5699C21.3605 36.5699 22.3605 36.6099 23.3205 36.7499C24.5705 36.9299 25.1505 37.5499 25.4205 38.0399C25.6905 38.5399 25.9005 39.3899 25.3305 40.5999C24.8205 41.6899 24.1605 42.7999 23.1805 44.1899C21.0105 47.2699 19.7805 50.7899 19.5205 54.6699C19.3005 57.9099 20.0205 60.5099 21.7405 62.6099C22.5805 63.6499 23.7405 64.0399 25.1705 63.7899C26.1405 63.6199 26.6605 62.9899 27.0905 61.4799L27.1305 61.3499C27.2805 60.8099 27.4305 60.2899 27.5005 59.7899C27.9005 56.9599 28.9705 54.3199 30.6805 51.9599C33.1605 48.5199 35.2005 46.0199 37.2805 43.8699C39.2305 41.8499 41.3605 39.9399 43.4105 38.0999C44.4705 37.1499 45.5305 36.1999 46.5605 35.2399C48.5605 33.3699 49.4305 31.3099 49.3005 28.7399C49.2005 26.7399 49.2205 24.7199 49.2405 22.7599C49.2405 21.9099 49.2605 21.0499 49.2605 20.1999C49.2605 19.0999 49.2705 17.9999 49.2805 16.8899C49.3105 14.4899 49.3305 12.0199 49.2205 9.59993C49.0805 6.60993 48.1305 5.52993 45.1705 4.95993C43.7005 4.67993 42.1705 4.51993 40.6805 4.36993C39.8805 4.28993 39.0705 4.19993 38.2705 4.09993C36.6105 3.88993 34.9605 3.65993 33.3005 3.42993C29.5905 2.90993 25.7505 2.37993 21.9805 2.09993C18.9605 1.86993 15.6905 2.04993 12.2705 2.61993C11.0405 2.82993 10.0105 3.43993 9.36048 4.35993C8.77048 5.19993 8.55048 6.22993 8.73048 7.24993C9.16048 9.64993 8.50048 11.4399 6.65048 12.8699C5.51048 13.7599 5.17048 14.8899 5.65048 16.2499C6.39048 18.3399 5.96048 20.1699 4.33048 21.8499C3.45048 22.7599 3.18048 23.8599 3.55048 24.9599C4.28048 27.0899 3.52048 28.7199 2.76048 30.0799C1.96048 31.4999 1.80048 32.9399 2.29048 34.1499C2.79048 35.3599 3.94048 36.2699 5.52048 36.7199C6.29048 36.9399 6.97048 37.1099 7.61048 37.0899C9.45048 37.0299 11.3005 36.9399 13.1405 36.8399C14.8705 36.7499 16.5905 36.6699 18.3205 36.5999C18.9705 36.5799 19.6805 36.5499 20.4305 36.5499L20.4205 36.5699Z" fill="currentColor" />
                                                    <path d="M58.6991 34.47C57.8491 34.47 56.9891 34.47 56.1391 34.46C53.9791 34.43 52.9291 33.4 52.9291 31.32C52.9091 22.55 52.9091 13.78 52.9291 4.99998C52.9291 2.88998 53.9491 1.88998 56.1391 1.86998C58.1491 1.84998 60.1691 1.84998 62.1791 1.86998C64.3591 1.89998 65.2891 2.84998 65.2991 5.04998C65.3091 8.17998 65.2991 11.31 65.2991 14.45V18.14V21.69C65.2991 24.77 65.2991 27.85 65.2991 30.94C65.2991 33.53 64.3591 34.45 61.7391 34.46H60.9791C60.2191 34.46 59.4591 34.46 58.6991 34.46V34.47ZM59.0491 3.84998C58.0791 3.84998 57.1191 3.84998 56.1491 3.85998C55.0191 3.86998 54.9291 4.03998 54.9291 4.98998C54.9091 13.76 54.9091 22.53 54.9291 31.3C54.9291 32.22 55.0491 32.43 56.1691 32.45C57.7691 32.47 59.3691 32.46 60.9791 32.45H61.7391C63.2691 32.45 63.2991 32.41 63.2991 30.92C63.2991 27.84 63.2991 24.76 63.2991 21.68V14.43C63.2991 11.3 63.2991 8.16998 63.2891 5.03998C63.2891 3.89998 63.1891 3.85998 62.1491 3.84998C61.1191 3.83998 60.0891 3.82998 59.0491 3.82998V3.84998Z" fill="currentColor" />
                                                </svg>
                                            </label>
                                        </li>
                                    </ul>
                                </div>
                            <?php elseif ($current_type === 'choise') : ?>
                                <?php
                                $choises = explode("\n", $question_data['choises']);
                                ?>
                                <div class="goal">
                                    <p class="h4 title mb-4 pb-2 pb-lg-3"><?php echo $question_data['question']; ?></p>
                                    <ul class="goal-list d-flex">
                                        <?php foreach ($choises as $choise_index => $choise_value) : ?>
                                            <li class="radio-toolbar">
                                                <input type="radio" id="goal-<?php echo $index; ?>-<?php echo $choise_index; ?>" name="goal<?php echo $index; ?>" value="<?php echo $choise_value; ?>">
                                                <label for="goal-<?php echo $index; ?>-<?php echo $choise_index; ?>"><?php echo $choise_value; ?></label>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                </div>
                            <?php elseif ($current_type === 'textarea') : ?>
                                <li>
                                    <label for="question-<?php echo $index; ?>">
                                        <?php echo $question_data['question']; ?>
                                    </label>
                                    <textarea id="question-<?php echo $index; ?>" name="overview<?php echo $index; ?>" rows="4" cols="50" required placeholder="<?php echo $question_data['placeholder']; ?>"></textarea>
                                </li>
                            <?php elseif ($current_type === 'text') : ?>
                                <li>
                                    <label for="question-<?php echo $index; ?>">
                                        <?php echo $question_data['question']; ?>
                                    </label>
                                    <input id="question-<?php echo $index; ?>" type="text" name="overview<?php echo $index; ?>" required placeholder="<?php echo $question_data['placeholder']; ?>">
                                </li>
                            <?php endif; ?>

                            <?php
                            $prev_type = $current_type;
                            ?>

                        <?php endforeach; ?>

                        <?php if ($openned_list) : ?>
                            <?php echo "</ul>"; ?>
                        <?php endif; ?>

                        <p class="thanks"><?php echo $icoda_feedback_thankyou_text; ?></p>

                        <div class="btn-wrap">
                            <button type="submit" class="btn btn-blue"><?php _e('Send', 'icoda'); ?></button>
                        </div>

                    </form>

                </div>
            </div>
        </div>
    </section>
</main>
<?php
get_footer(); ?>